#include <stdio.h>
#include <stdlib.h>
#include <math.h>

#define N 3  // Количество узлов (x = 0.7, 0.8, 0.9, 1.0)
#define h 0.1

void gauss_elimination(double A[N][N+1], double x[N]) {
    // Прямой ход метода Гаусса
    for (int i = 0; i < N; i++) {
        for (int k = i + 1; k < N; k++) {
            double factor = A[k][i] / A[i][i];
            for (int j = i; j <= N; j++) {
                A[k][j] -= factor * A[i][j];
            }
        }
    }

    // Обратный ход метода Гаусса
    for (int i = N - 1; i >= 0; i--) {
        x[i] = A[i][N];
        for (int j = i + 1; j < N; j++) {
            x[i] -= A[i][j] * x[j];
        }
        x[i] /= A[i][i];
    }
}

int main() {
    double A[N][N+1] = {0};  // Матрица коэффициентов и правых частей
    double x[N] = {0};       // Решение системы
    double y[N+1] = {0};     // Значения y в узлах (включая граничные)

    // Заполнение матрицы A и вектора b для внутренних узлов
    for (int i = 1; i < N-1; i++) {
        double xi = 0.7 + i * h;
        A[i][i-1] = 1 + 1.5 * xi * h;  // Коэффициент для y_{i-1}
        A[i][i] = -2 - 2 * h * h;      // Коэффициент для y_i
        A[i][i+1] = 1 - 1.5 * xi * h;  // Коэффициент для y_{i+1}
        A[i][N] = 1.5 * h * h;         // Правая часть уравнения
    }

    // Краевое условие y'(0.7) = 1.3
    A[0][0] = -1;  // Коэффициент для y_0
    A[0][1] = 1;   // Коэффициент для y_1
    A[0][N] = 2.6 * h;  // Правая часть (2 * h * 1.3)

    // Краевое условие 0.5y(1) + y'(1) = 1.2
    A[N-1][N-2] = -1;  // Коэффициент для y_{N-2}
    A[N-1][N-1] = 0.5 + 1 / (2 * h);  // Коэффициент для y_{N-1}
    A[N-1][N] = 1.2;  // Правая часть

    // Решение системы методом Гаусса
    gauss_elimination(A, x);

    // Заполнение массива y (включая граничные точки)
    y[0] = x[0];  // y(0.7)
    y[1] = x[1];  // y(0.8)
    y[2] = x[2];  // y(0.9)
    y[3] = x[2];  // y(1.0) - используется значение из предыдущего узла

    // Вывод результатов в виде таблицы
    printf("x\t\ty\n");
    for (int i = 0; i <= N; i++) {
        double xi = 0.7 + i * h;
        printf("%.2f\t%.6f\n", xi, y[i]);
    }

    return 0;
}